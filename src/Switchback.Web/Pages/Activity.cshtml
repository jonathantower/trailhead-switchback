@page
@model ActivityModel
@{
    ViewData["Title"] = "Activity";
}

<div class="page-header">
    <h1>Recent activity</h1>
    <p class="description">Emails processed by Switchback in the last 50 actions.</p>
</div>

@if (!string.IsNullOrEmpty(Model.Error))
{
    <div class="alert-error">@Model.Error</div>
}

@if (Model.Activities.Count == 0 && string.IsNullOrEmpty(Model.Error))
{
    <div class="info-banner">
        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>
        <span>No activity yet. Processed emails will appear here (last 50).</span>
    </div>
}
else
{
    <div class="table-wrapper">
        <table>
            <thead>
                <tr>
                    <th>Processed</th>
                    <th>Subject</th>
                    <th>Rule</th>
                    <th>Destination</th>
                    <th>Provider</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var a in Model.Activities)
                {
                    <tr>
                        <td>@a.ProcessedAt.ToString("yyyy-MM-dd HH:mm")</td>
                        <td>@(a.Subject.Length > 60 ? a.Subject[..60] + "â€¦" : a.Subject)</td>
                        <td>@a.RuleApplied</td>
                        <td>@a.Destination</td>
                        <td>@a.Provider</td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
}
